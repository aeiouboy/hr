# Payroll & Finance (เงินเดือนและการเงิน)

เอกสารนี้อธิบาย module ที่เกี่ยวกับการจัดการเงินเดือน ค่าตอบแทน และรายงานทางการเงิน

---

## ตั้งค่าเงินเดือน (`payroll-setup`)

**หน้าที่หลัก:** จัดการข้อมูล master สำหรับระบบเงินเดือน ครอบคลุมทั้งประเภทรายได้ ประเภทการหัก ตารางอัตราภาษี และข้อมูลธนาคาร เป็นหน้าตั้งต้นที่ HR ต้องกำหนดก่อนเริ่มประมวลผลเงินเดือน

**ใครใช้ได้บ้าง:** HR Admin / HR Manager

**สิ่งที่ทำได้:**
- ดูรายการประเภทรายได้ทั้งหมด แบ่งตามหมวดหมู่ (เช่น เงินเดือนพื้นฐาน ค่าตำแหน่ง โอที)
- ดูรายการประเภทการหักเงินทั้งหมด แบ่งตามหมวดหมู่ (เช่น ภาษี ประกันสังคม กองทุนสำรองเลี้ยงชีพ เงินกู้)
- ดูตารางภาษีเงินได้บุคคลธรรมดาแบบอัตราก้าวหน้า (Progressive Tax)
- ดูค่าลดหย่อนมาตรฐานทุกประเภท (ส่วนตัว คู่สมรส บุตร บิดามารดา ประกันชีวิต ฯลฯ)
- ดูการตั้งค่าประกันสังคม (อัตราพนักงาน / นายจ้าง / เพดานเงินเดือน)
- ดูการตั้งค่ากองทุนสำรองเลี้ยงชีพ (อัตราสมทบและตาราง Vesting Schedule)
- ดูรายชื่อธนาคารที่รองรับการโอนเงินเดือน พร้อม SWIFT Code
- ดูรูปแบบการจ่ายเงิน (โอนธนาคาร เช็ค เงินสด) และรอบการจ่ายเงินเดือน (รายเดือน รายปักษ์ ฯลฯ)
- สลับดูระหว่าง 4 แท็บ: รายได้ / การหัก / ภาษี / ธนาคาร

**ข้อมูลที่แสดง:**
- สรุปจำนวนประเภทรายได้ทั้งหมด แยกตามสถานะ active / taxable / รวมประกันสังคม
- สรุปจำนวนประเภทการหักทั้งหมด แยกตามสถานะ active / mandatory / ประเภทเงินกู้
- ตารางอัตราภาษีก้าวหน้า (0% - 35%) พร้อมช่วงรายได้แต่ละขั้น
- รายละเอียดค่าลดหย่อนแต่ละประเภทพร้อมวงเงินสูงสุด
- อัตราสมทบประกันสังคม (พนักงาน 5%, นายจ้าง 5%, เพดานฐานค่าจ้าง 15,000 บาท)
- อัตราสมทบกองทุนสำรองเลี้ยงชีพ (พนักงาน 2–15%, นายจ้าง 2–15%)
- รายการธนาคารทั้งหมดพร้อมสถานะ active/inactive

**หมายเหตุ:** หน้านี้เป็น read-only สำหรับการดูข้อมูล master ที่ตั้งค่าในระบบ ไม่มีฟังก์ชัน add/edit/delete ในปัจจุบัน

---

## ประมวลผลเงินเดือน (`payroll-processing`)

**หน้าที่หลัก:** ดำเนินการประมวลผลเงินเดือนรายเดือนสำหรับพนักงานทุกคน โดยใช้ขั้นตอนแบบ Wizard 4 ขั้น ตั้งแต่เลือกงวด คำนวณ ตรวจสอบ จนถึงส่งอนุมัติ

**ใครใช้ได้บ้าง:** HR Admin / HR Manager (พนักงานและ Manager ไม่มีสิทธิ์เข้าถึง)

**สิ่งที่ทำได้:**
- เลือกงวดเงินเดือนที่ต้องการประมวลผล (ย้อนหลัง 12 เดือน หรือล่วงหน้า 2 เดือน)
- กรองตามแผนก (IT, HR, Finance, Operations หรือทั้งหมด)
- กดปุ่มรัน "คำนวณเงินเดือน" แล้วระบบจะคำนวณอัตโนมัติ
- ค้นหาชื่อพนักงานในผลการคำนวณ
- ตรวจสอบสรุปยอดรวมแยกตามแผนก
- ดูรายการพนักงานที่มี variance เกิน 10% เพื่อตรวจสอบความผิดปกติ
- บันทึกเป็น Draft เพื่อรอดำเนินการต่อ
- ส่งผลการคำนวณเพื่อขออนุมัติผ่าน Workflow
- Export ไฟล์เงินเดือนเมื่อสถานะเป็น completed
- ดูประวัติการรันเงินเดือนย้อนหลัง

**ข้อมูลที่แสดง:**
- Wizard Progress Bar แสดง 4 ขั้นตอน: เลือกงวด / คำนวณ / ตรวจสอบ / อนุมัติ
- ตารางผลคำนวณรายบุคคล: รหัสพนักงาน / ชื่อ / เงินได้รวม / ภาษีหัก ณ ที่จ่าย / ประกันสังคม / กองทุนสำรองเลี้ยงชีพ / เงินสุทธิ / % variance
- Summary Cards: จำนวนพนักงาน / รวมเงินได้รวม / รวมรายการหัก / รวมเงินสุทธิ
- ตารางสรุปยอดแยกตามแผนก พร้อม grand total
- รายการ variance exceptions (พนักงานที่ยอดต่างจากเดือนก่อนเกิน 10%)
- ประวัติการรันเงินเดือน (งวด / จำนวนพนักงาน / ยอดรวม / สถานะ)

**หมายเหตุ:** การส่งอนุมัติต้องผ่าน 2 ระดับ คือ HR Manager และ Finance Director ระบบคำนวณภาษีตามอัตราก้าวหน้าของไทย ประกันสังคมที่ 5% (สูงสุด 750 บาท/เดือน) และกองทุนสำรองเลี้ยงชีพตามอัตราที่พนักงานเลือก

---

## รายงานราชการ (`government-reports`)

**หน้าที่หลัก:** สร้างและดาวน์โหลดรายงานภาษีและประกันสังคมที่ต้องส่งหน่วยงานราชการไทยตามกฎหมาย ทั้งรายเดือนและรายปี

**ใครใช้ได้บ้าง:** HR Admin / HR Manager

**สิ่งที่ทำได้:**
- เลือกประเภทรายงานราชการที่ต้องการสร้าง (4 ประเภท)
- กำหนดช่วงเวลา: เดือน/ปี สำหรับรายงานรายเดือน หรือปีสำหรับรายงานรายปี
- กรองตามบริษัทในกลุ่ม (สำหรับองค์กรที่มีหลายนิติบุคคล)
- สร้างรายงานในรูปแบบ Excel (.xlsx)
- สร้างรายงานในรูปแบบ PDF
- ดาวน์โหลดรายงานที่สร้างแล้ว
- ดูประวัติรายงานที่เคยสร้างไว้ (เก็บ 10 รายการล่าสุด)

**ข้อมูลที่แสดง:**
- การ์ดเลือกประเภทรายงาน 4 ประเภท:
  - **ภ.ง.ด.1** (PND1) — ภาษีเงินได้หัก ณ ที่จ่าย รายเดือน ส่งกรมสรรพากรภายในวันที่ 7 ของเดือนถัดไป (หรือวันที่ 15 หากยื่นออนไลน์)
  - **ภ.ง.ด.1ก** (PND1K) — สรุปภาษีเงินได้หัก ณ ที่จ่าย ประจำปี ส่งกรมสรรพากรภายในเดือนกุมภาพันธ์ของปีถัดไป
  - **50 ทวิ** (50 Tawi) — หนังสือรับรองการหักภาษี ณ ที่จ่าย สำหรับพนักงานแต่ละคน (PDF เท่านั้น) ออกให้พนักงานภายใน 15 กุมภาพันธ์
  - **สปส. 1-10** (SSO 1-10) — รายงานส่งเงินสมทบประกันสังคม รายเดือน ส่งสำนักงานประกันสังคมภายในวันที่ 15 ของเดือนถัดไป
- ข้อมูลที่รวมอยู่ในแต่ละรายงาน วันครบกำหนด และหน่วยงานที่ต้องส่ง
- ประวัติรายงานที่สร้างแล้ว: ประเภท / งวด / วันที่สร้าง / รูปแบบไฟล์ / ปุ่มดาวน์โหลด

**หมายเหตุ:** ระบบจะบันทึก log การดาวน์โหลดรายงานทุกครั้งเพื่อ audit trail รายงาน 50 ทวิ รองรับเฉพาะ PDF รายงานอื่นรองรับทั้ง Excel และ PDF

---

## ค่าตอบแทน (`compensation`)

**หน้าที่หลัก:** แสดงข้อมูลค่าตอบแทนของพนักงานในโปรไฟล์ ครอบคลุมข้อมูลการจ่ายเงิน เงินเดือน สลิปเงินเดือน และเอกสารภาษี

**ใครใช้ได้บ้าง:**
- พนักงาน — ดูข้อมูลการจ่ายเงิน ดาวน์โหลดสลิปเงินเดือนและเอกสารภาษีของตัวเอง (ไม่เห็นยอดเงินเดือน)
- HR Manager — ดูและแก้ไขข้อมูลทั้งหมด รวมถึงยอดเงินเดือน

**สิ่งที่ทำได้:**
- ดูข้อมูลการจ่ายเงิน (ประเทศ วิธีการจ่าย ประเภทการจ่าย ธนาคาร เลขบัญชี)
- ดูยอดเงินเดือนรวม (gross) ต่อเดือน (เฉพาะผู้มีสิทธิ์ view_salary_details)
- ดูรายการสลิปเงินเดือนทุกงวด พร้อมวันที่จ่าย
- ดาวน์โหลดสลิปเงินเดือนเป็น PDF รายงวด
- ดูรายการเอกสารภาษี (เช่น หนังสือรับรองภาษีหัก ณ ที่จ่าย 50 ทวิ) พร้อมปีภาษีและวันที่ออก
- ดาวน์โหลดเอกสารภาษีเป็น PDF

**ข้อมูลที่แสดง:**
- บัตรข้อมูลการจ่ายเงิน: ประเทศงาน / วิธีการจ่าย / ประเภทการจ่าย / ธนาคาร / เลขบัญชี (masking บางส่วน)
- บัตรเงินเดือน: ยอด gross ต่อเดือน (แสดงเฉพาะ HR Manager)
- ตารางสลิปเงินเดือน: งวด / วันที่จ่าย / เงินได้รวม / เงินสุทธิ / ปุ่มดาวน์โหลด
- ตารางเอกสารภาษี: ประเภทเอกสาร / ปีภาษี / วันที่ออก / ปุ่มดาวน์โหลด

**หมายเหตุ:** ระบบ RBAC ควบคุมการมองเห็นข้อมูลเงินเดือนอย่างเข้มงวด พนักงานทั่วไปจะเห็นสลิปเงินเดือนและเอกสารภาษีได้ แต่จะไม่เห็นคอลัมน์ยอดเงินเดือนในตาราง เลขบัญชีธนาคารจะแสดงแบบ masking เพื่อความปลอดภัย

---

## สวัสดิการ (`benefits`)

**หน้าที่หลัก:** แสดงภาพรวมสวัสดิการที่พนักงานได้รับ และรายละเอียดของแผนสวัสดิการแต่ละแผนที่ลงทะเบียนไว้

**ใครใช้ได้บ้าง:**
- พนักงาน — ดูสวัสดิการของตัวเอง (permission: view_own_benefits)
- HR Admin / HR Manager — ดูสวัสดิการของพนักงานทุกคน (permission: view_all_benefits) และ HR Manager จัดการสวัสดิการได้ (permission: manage_benefits)

**สิ่งที่ทำได้:**
- ดูสรุปสวัสดิการทั้งหมดที่ตัวเองมี
- ดูรายละเอียดแต่ละแผนสวัสดิการที่ลงทะเบียน (ชื่อแผน ความคุ้มครอง วันที่มีผล)
- ดูจำนวนผู้ติดตาม (dependents) ที่ได้รับความคุ้มครองในแต่ละแผน

**ข้อมูลที่แสดง:**
- Summary Cards 4 ช่อง: จำนวนสวัสดิการ Active / จำนวนแผนทั้งหมด / จำนวนแผนที่มีผู้ติดตาม / จำนวนรายการรอดำเนินการ
- การ์ดสวัสดิการรายแผน แสดง:
  - ไอคอนตามประเภท (สุขภาพ / ชีวิต / ทันตกรรม / กองทุนเกษียณ / อุบัติเหตุ)
  - ชื่อแผนและขอบเขตความคุ้มครอง
  - วันที่มีผลบังคับ
  - จำนวน dependents ที่คุ้มครอง (ถ้ามี)
  - badge สถานะ: Active (เขียว) / Inactive (เทา) / Pending (เหลือง)

**หมายเหตุ:** หน้านี้เป็น read-only แสดงข้อมูลสวัสดิการที่ HR ลงทะเบียนให้พนักงาน ไม่มีฟังก์ชัน self-enroll ในปัจจุบัน การจัดการสวัสดิการทำโดย HR Manager ผ่าน module บริหารสวัสดิการแยกต่างหาก
