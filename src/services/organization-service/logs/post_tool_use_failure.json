[
  {
    "timestamp": "2026-02-22T17:09:08.034119",
    "session_id": "dafff119-1736-4770-bb13-d89455f8d434",
    "hook_event_name": "PostToolUseFailure",
    "tool_name": "Bash",
    "tool_use_id": "toolu_01MhQCYRicwegEc2WvB36rYJ",
    "tool_input": {
      "command": "npx jest --no-cache --forceExit 2>&1",
      "timeout": 120000,
      "description": "Run organization service tests"
    },
    "error": "Exit code 1\nFAIL test/integration/organization.integration.spec.ts\n  \u25cf Test suite failed to run\n\n    \u001b[96mtest/integration/organization.integration.spec.ts\u001b[0m:\u001b[93m30\u001b[0m:\u001b[93m29\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS1127: \u001b[0mInvalid character.\n\n    \u001b[7m30\u001b[0m     await prisma.$executeRaw\\`DELETE FROM \"incumbents\" WHERE employee_id LIKE 'TEST_%'\\`;\n    \u001b[7m  \u001b[0m \u001b[91m                            \u001b[0m\n    \u001b[96mtest/integration/organization.integration.spec.ts\u001b[0m:\u001b[93m181\u001b[0m:\u001b[93m1\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS1160: \u001b[0mUnterminated template literal.\n\n    \u001b[7m181\u001b[0m \n    \u001b[7m   \u001b[0m \u001b[91m\u001b[0m\n\nPASS test/unit/org-chart.service.spec.ts\nPASS test/unit/transfer.service.spec.ts\nPASS test/unit/position.service.spec.ts\nPASS test/unit/org.controller.spec.ts\n\nTest Suites: 1 failed, 4 passed, 5 total\nTests:       49 passed, 49 total\nSnapshots:   0 total\nTime:        2.54 s\nRan all test suites.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?\n\nFAIL test/integration/organization.integration.spec.ts\n  \u25cf Test suite failed to run\n\n    \u001b[96mtest/integration/organization.integration.spec.ts\u001b[0m:\u001b[93m30\u001b[0m:\u001b[93m29\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS1127: \u001b[0mInvalid character.\n\n    \u001b[7m30\u001b[0m     await prisma.$executeRaw\\`DELETE FROM \"incumbents\" WHERE employee_id LIKE 'TEST_%'\\`;\n    \u001b[7m  \u001b[0m \u001b[91m                            \u001b[0m\n    \u001b[96mtest/integration/organization.integration.spec.ts\u001b[0m:\u001b[93m181\u001b[0m:\u001b[93m1\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS1160: \u001b[0mUnterminated template literal.\n\n    \u001b[7m181\u001b[0m \n    \u001b[7m   \u001b[0m \u001b[91m\u001b[0m\n\nPASS test/unit/org-chart.service.spec.ts\nPASS test/unit/transfer.service.spec.ts\nPASS test/unit/position.service.spec.ts\nPASS test/unit/org.controller.spec.ts\n\nTest Suites: 1 failed, 4 passed, 5 total\nTests:       49 passed, 49 total\nSnapshots:   0 total\nTime:        2.54 s\nRan all test suites.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?",
    "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
    "permission_mode": "bypassPermissions",
    "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/dafff119-1736-4770-bb13-d89455f8d434.jsonl",
    "raw_input": {
      "session_id": "dafff119-1736-4770-bb13-d89455f8d434",
      "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/dafff119-1736-4770-bb13-d89455f8d434.jsonl",
      "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
      "permission_mode": "bypassPermissions",
      "hook_event_name": "PostToolUseFailure",
      "tool_name": "Bash",
      "tool_input": {
        "command": "npx jest --no-cache --forceExit 2>&1",
        "timeout": 120000,
        "description": "Run organization service tests"
      },
      "tool_use_id": "toolu_01MhQCYRicwegEc2WvB36rYJ",
      "error": "Exit code 1\nFAIL test/integration/organization.integration.spec.ts\n  \u25cf Test suite failed to run\n\n    \u001b[96mtest/integration/organization.integration.spec.ts\u001b[0m:\u001b[93m30\u001b[0m:\u001b[93m29\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS1127: \u001b[0mInvalid character.\n\n    \u001b[7m30\u001b[0m     await prisma.$executeRaw\\`DELETE FROM \"incumbents\" WHERE employee_id LIKE 'TEST_%'\\`;\n    \u001b[7m  \u001b[0m \u001b[91m                            \u001b[0m\n    \u001b[96mtest/integration/organization.integration.spec.ts\u001b[0m:\u001b[93m181\u001b[0m:\u001b[93m1\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS1160: \u001b[0mUnterminated template literal.\n\n    \u001b[7m181\u001b[0m \n    \u001b[7m   \u001b[0m \u001b[91m\u001b[0m\n\nPASS test/unit/org-chart.service.spec.ts\nPASS test/unit/transfer.service.spec.ts\nPASS test/unit/position.service.spec.ts\nPASS test/unit/org.controller.spec.ts\n\nTest Suites: 1 failed, 4 passed, 5 total\nTests:       49 passed, 49 total\nSnapshots:   0 total\nTime:        2.54 s\nRan all test suites.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?\n\nFAIL test/integration/organization.integration.spec.ts\n  \u25cf Test suite failed to run\n\n    \u001b[96mtest/integration/organization.integration.spec.ts\u001b[0m:\u001b[93m30\u001b[0m:\u001b[93m29\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS1127: \u001b[0mInvalid character.\n\n    \u001b[7m30\u001b[0m     await prisma.$executeRaw\\`DELETE FROM \"incumbents\" WHERE employee_id LIKE 'TEST_%'\\`;\n    \u001b[7m  \u001b[0m \u001b[91m                            \u001b[0m\n    \u001b[96mtest/integration/organization.integration.spec.ts\u001b[0m:\u001b[93m181\u001b[0m:\u001b[93m1\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS1160: \u001b[0mUnterminated template literal.\n\n    \u001b[7m181\u001b[0m \n    \u001b[7m   \u001b[0m \u001b[91m\u001b[0m\n\nPASS test/unit/org-chart.service.spec.ts\nPASS test/unit/transfer.service.spec.ts\nPASS test/unit/position.service.spec.ts\nPASS test/unit/org.controller.spec.ts\n\nTest Suites: 1 failed, 4 passed, 5 total\nTests:       49 passed, 49 total\nSnapshots:   0 total\nTime:        2.54 s\nRan all test suites.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?",
      "is_interrupt": false,
      "logged_at": "2026-02-22T17:09:08.034119"
    }
  },
  {
    "timestamp": "2026-02-22T17:09:28.772927",
    "session_id": "dafff119-1736-4770-bb13-d89455f8d434",
    "hook_event_name": "PostToolUseFailure",
    "tool_name": "Bash",
    "tool_use_id": "toolu_01XJBbP6mBWpEFYu3XRMFT35",
    "tool_input": {
      "command": "npx jest --no-cache --forceExit 2>&1",
      "timeout": 120000,
      "description": "Run all organization service tests"
    },
    "error": "Exit code 1\nPASS test/unit/position.service.spec.ts\nPASS test/unit/transfer.service.spec.ts\nPASS test/unit/org-chart.service.spec.ts\nPASS test/unit/org.controller.spec.ts\nFAIL test/integration/organization.integration.spec.ts\n  \u25cf Organization Service Integration \u203a should create and retrieve a department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create a position linked to department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create org nodes and reporting lines\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create and manage transfer requests\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should enforce unique position_code constraint\n\n    PrismaClientIn\n\n... [2692 characters truncated] ...\n\nrganization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create a position linked to department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create org nodes and reporting lines\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create and manage transfer requests\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should enforce unique position_code constraint\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\nTest Suites: 1 failed, 4 passed, 5 total\nTests:       5 failed, 49 passed, 54 total\nSnapshots:   0 total\nTime:        3.064 s\nRan all test suites.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?",
    "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
    "permission_mode": "bypassPermissions",
    "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/dafff119-1736-4770-bb13-d89455f8d434.jsonl",
    "raw_input": {
      "session_id": "dafff119-1736-4770-bb13-d89455f8d434",
      "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/dafff119-1736-4770-bb13-d89455f8d434.jsonl",
      "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
      "permission_mode": "bypassPermissions",
      "hook_event_name": "PostToolUseFailure",
      "tool_name": "Bash",
      "tool_input": {
        "command": "npx jest --no-cache --forceExit 2>&1",
        "timeout": 120000,
        "description": "Run all organization service tests"
      },
      "tool_use_id": "toolu_01XJBbP6mBWpEFYu3XRMFT35",
      "error": "Exit code 1\nPASS test/unit/position.service.spec.ts\nPASS test/unit/transfer.service.spec.ts\nPASS test/unit/org-chart.service.spec.ts\nPASS test/unit/org.controller.spec.ts\nFAIL test/integration/organization.integration.spec.ts\n  \u25cf Organization Service Integration \u203a should create and retrieve a department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create a position linked to department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create org nodes and reporting lines\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create and manage transfer requests\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should enforce unique position_code constraint\n\n    PrismaClientIn\n\n... [2692 characters truncated] ...\n\nrganization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create a position linked to department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create org nodes and reporting lines\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create and manage transfer requests\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should enforce unique position_code constraint\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\nTest Suites: 1 failed, 4 passed, 5 total\nTests:       5 failed, 49 passed, 54 total\nSnapshots:   0 total\nTime:        3.064 s\nRan all test suites.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?",
      "is_interrupt": false,
      "logged_at": "2026-02-22T17:09:28.772927"
    }
  },
  {
    "timestamp": "2026-02-22T17:09:58.431688",
    "session_id": "cd20b975-220b-4bf6-af79-435ac082b2c4",
    "hook_event_name": "PostToolUseFailure",
    "tool_name": "Read",
    "tool_use_id": "toolu_01KDMohTypNV2xNb77cfa4Ch",
    "tool_input": {
      "file_path": "/Users/tachongrak/Projects/hr/src/frontend/messages/en.json"
    },
    "error": "File content (31636 tokens) exceeds maximum allowed tokens (25000). Please use offset and limit parameters to read specific portions of the file, or use the GrepTool to search for specific content.",
    "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
    "permission_mode": "bypassPermissions",
    "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/cd20b975-220b-4bf6-af79-435ac082b2c4.jsonl",
    "raw_input": {
      "session_id": "cd20b975-220b-4bf6-af79-435ac082b2c4",
      "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/cd20b975-220b-4bf6-af79-435ac082b2c4.jsonl",
      "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
      "permission_mode": "bypassPermissions",
      "hook_event_name": "PostToolUseFailure",
      "tool_name": "Read",
      "tool_input": {
        "file_path": "/Users/tachongrak/Projects/hr/src/frontend/messages/en.json"
      },
      "tool_use_id": "toolu_01KDMohTypNV2xNb77cfa4Ch",
      "error": "File content (31636 tokens) exceeds maximum allowed tokens (25000). Please use offset and limit parameters to read specific portions of the file, or use the GrepTool to search for specific content.",
      "is_interrupt": false,
      "logged_at": "2026-02-22T17:09:58.431688"
    }
  },
  {
    "timestamp": "2026-02-22T17:09:58.854822",
    "session_id": "cd20b975-220b-4bf6-af79-435ac082b2c4",
    "hook_event_name": "PostToolUseFailure",
    "tool_name": "Read",
    "tool_use_id": "toolu_01NQxabZNK8xfqY5FeaxSJew",
    "tool_input": {
      "file_path": "/Users/tachongrak/Projects/hr/src/frontend/messages/th.json"
    },
    "error": "File content (58606 tokens) exceeds maximum allowed tokens (25000). Please use offset and limit parameters to read specific portions of the file, or use the GrepTool to search for specific content.",
    "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
    "permission_mode": "bypassPermissions",
    "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/cd20b975-220b-4bf6-af79-435ac082b2c4.jsonl",
    "raw_input": {
      "session_id": "cd20b975-220b-4bf6-af79-435ac082b2c4",
      "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/cd20b975-220b-4bf6-af79-435ac082b2c4.jsonl",
      "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
      "permission_mode": "bypassPermissions",
      "hook_event_name": "PostToolUseFailure",
      "tool_name": "Read",
      "tool_input": {
        "file_path": "/Users/tachongrak/Projects/hr/src/frontend/messages/th.json"
      },
      "tool_use_id": "toolu_01NQxabZNK8xfqY5FeaxSJew",
      "error": "File content (58606 tokens) exceeds maximum allowed tokens (25000). Please use offset and limit parameters to read specific portions of the file, or use the GrepTool to search for specific content.",
      "is_interrupt": false,
      "logged_at": "2026-02-22T17:09:58.854822"
    }
  },
  {
    "timestamp": "2026-02-22T17:10:14.603054",
    "session_id": "cd20b975-220b-4bf6-af79-435ac082b2c4",
    "hook_event_name": "PostToolUseFailure",
    "tool_name": "Bash",
    "tool_use_id": "toolu_01PeY8qP2CDMedZEAEeJHni5",
    "tool_input": {
      "command": "npx jest --no-cache --forceExit 2>&1",
      "timeout": 120000,
      "description": "Run organization-service tests"
    },
    "error": "Exit code 1\nPASS test/unit/org-chart.service.spec.ts\nPASS test/unit/transfer.service.spec.ts (5.047 s)\nPASS test/unit/position.service.spec.ts (5.448 s)\nPASS test/unit/org.controller.spec.ts (6.56 s)\nFAIL test/integration/organization.integration.spec.ts (6.865 s)\n  \u25cf Organization Service Integration \u203a should create and retrieve a department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create a position linked to department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create org nodes and reporting lines\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create and manage transfer requests\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should enforce unique posit\n\n... [2770 characters truncated] ...\n\nrganization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create a position linked to department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create org nodes and reporting lines\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create and manage transfer requests\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should enforce unique position_code constraint\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\nTest Suites: 1 failed, 4 passed, 5 total\nTests:       5 failed, 49 passed, 54 total\nSnapshots:   0 total\nTime:        7.725 s\nRan all test suites.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?",
    "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
    "permission_mode": "bypassPermissions",
    "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/cd20b975-220b-4bf6-af79-435ac082b2c4.jsonl",
    "raw_input": {
      "session_id": "cd20b975-220b-4bf6-af79-435ac082b2c4",
      "transcript_path": "/Users/tachongrak/.claude/projects/-Users-tachongrak-Projects-hr/cd20b975-220b-4bf6-af79-435ac082b2c4.jsonl",
      "cwd": "/Users/tachongrak/Projects/hr/src/services/organization-service",
      "permission_mode": "bypassPermissions",
      "hook_event_name": "PostToolUseFailure",
      "tool_name": "Bash",
      "tool_input": {
        "command": "npx jest --no-cache --forceExit 2>&1",
        "timeout": 120000,
        "description": "Run organization-service tests"
      },
      "tool_use_id": "toolu_01PeY8qP2CDMedZEAEeJHni5",
      "error": "Exit code 1\nPASS test/unit/org-chart.service.spec.ts\nPASS test/unit/transfer.service.spec.ts (5.047 s)\nPASS test/unit/position.service.spec.ts (5.448 s)\nPASS test/unit/org.controller.spec.ts (6.56 s)\nFAIL test/integration/organization.integration.spec.ts (6.865 s)\n  \u25cf Organization Service Integration \u203a should create and retrieve a department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create a position linked to department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create org nodes and reporting lines\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create and manage transfer requests\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should enforce unique posit\n\n... [2770 characters truncated] ...\n\nrganization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create a position linked to department\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create org nodes and reporting lines\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should create and manage transfer requests\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\n  \u25cf Organization Service Integration \u203a should enforce unique position_code constraint\n\n    PrismaClientInitializationError: error: Environment variable not found: DATABASE_URL.\n      -->  schema.prisma:7\n       | \n     6 |   provider = \"postgresql\"\n     7 |   url      = env(\"DATABASE_URL\")\n       | \n\n    Validation Error Count: 1\n\n       5 | export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\n       6 |   async onModuleInit() {\n    >  7 |     await this.$connect();\n         |     ^\n       8 |   }\n       9 |\n      10 |   async onModuleDestroy() {\n\n      at r (../../../node_modules/@prisma/client/src/runtime/core/engines/library/LibraryEngine.ts:440:17)\n      at Proxy.onModuleInit (src/prisma/prisma.service.ts:7:5)\n          at async Promise.all (index 0)\n      at callModuleInitHook (../../../node_modules/@nestjs/core/hooks/on-module-init.hook.js:43:5)\n      at Proxy.callInitHook (../../../node_modules/@nestjs/core/nest-application-context.js:252:13)\n      at Proxy.init (../../../node_modules/@nestjs/core/nest-application.js:103:9)\n      at Object.<anonymous> (test/integration/organization.integration.spec.ts:20:5)\n\nTest Suites: 1 failed, 4 passed, 5 total\nTests:       5 failed, 49 passed, 54 total\nSnapshots:   0 total\nTime:        7.725 s\nRan all test suites.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?",
      "is_interrupt": false,
      "logged_at": "2026-02-22T17:10:14.603054"
    }
  }
]